<p-toast></p-toast>

<p-dialog 
  [header]="isEditMode ? 'Edit Draw' : 'Create New Draw'" 
  [(visible)]="visible"
  (visibleChange)="visibleChange.emit($event)"
  [modal]="true" 
  [closable]="true" 
  [style]="{ width: '40rem' }">

  <form [formGroup]="drawForm" (ngSubmit)="submitDraw()">
    <div class="p-fluid">
      <div class="field">
        <label for="prizeName">Prize Name *</label>
        <input 
          id="prizeName" 
          type="text" 
          pInputText 
          formControlName="prizeName" />
        <small class="p-error" *ngIf="isFieldInvalid('prizeName')">
          Prize name is required
        </small>
      </div>

      <div class="field">
        <label for="drawDate">Draw Date *</label>
        <p-calendar 
          id="drawDate" 
          formControlName="drawDate" 
          dateFormat="yy-mm-dd" 
          [showIcon]="true">
        </p-calendar>
        <small class="p-error" *ngIf="isFieldInvalid('drawDate')">
          Draw date is required
        </small>
      </div>

      <div class="field">
        <label for="description">Description</label>
        <textarea 
          pInputTextarea 
          id="description" 
          formControlName="description" 
          rows="3">
        </textarea>
      </div>

      <div class="field">
        <label for="status">Status *</label>
        <p-dropdown 
          id="status" 
          formControlName="status" 
          [options]="statusOptions" 
          optionLabel="label" 
          optionValue="value">
        </p-dropdown>
      </div>

      <div class="field">
        <label for="maxParticipants">Max Participants *</label>
        <p-inputNumber 
          id="maxParticipants" 
          formControlName="maxParticipants" 
          [min]="1">
        </p-inputNumber>
        <small class="p-error" *ngIf="isFieldInvalid('maxParticipants')">
          Max participants is required and must be at least 1
        </small>
      </div>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <button 
      pButton 
      type="button" 
      label="Cancel" 
      icon="pi pi-times" 
      class="p-button-text" 
      (click)="closeModal()"
      [disabled]="loading">
    </button>
    <button 
      pButton 
      type="button" 
      [label]="isEditMode ? 'Update' : 'Create'" 
      icon="pi pi-check" 
      [disabled]="drawForm.invalid || loading"
      [loading]="loading"
      (click)="submitDraw()">
    </button>
  </ng-template>
</p-dialog>